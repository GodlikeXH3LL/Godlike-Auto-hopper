local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/memejames/elerium-v2-ui-library/main/Library", true))()
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local window = library:AddWindow("Private Auto Hopper", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(700, 900),
    can_resize = true,
})

local AutoKill = window:AddTab("Auto Kill")
local Folder1 = AutoKill:AddFolder("Auto kill + hop")

Folder1:AddSwitch("Auto Kill + HOP", function(state)
    if not state then return end

    local LocalPlayer = Players.LocalPlayer
    local placeId = game.PlaceId

    local excludedNames = {
        ["U3RT_SOVIETxKILLA"] = true,
        ["U3RT_KILLAxSOVIET"] = true,
    }

    local function find18Or19PlayerServer()
        local cursor = nil
        repeat
            local url = "https://games.roblox.com/v1/games/"..placeId.."/servers/Public?sortOrder=Desc&limit=100"
            if cursor then
                url = url .. "&cursor=" .. cursor
            end

            local success, response = pcall(function()
                return HttpService:JSONDecode(game:HttpGet(url))
            end)

            if success and response and response.data then
                for _, server in ipairs(response.data) do
                    if server.playing == 18 and server.maxPlayers == 20 and server.id ~= game.JobId then
                        return server.id
                    end
                end
                cursor = response.nextPageCursor
            else
                break
            end
        until not cursor
        return nil
    end

    local function hopToServer()
        local serverId = find18Or19PlayerServer()
        if serverId then
            TeleportService:TeleportToPlaceInstance(placeId, serverId, LocalPlayer)
        else
            warn("No 18-player servers found! Retrying in 5 seconds...")
            task.delay(5, hopToServer)
        end
    end

    task.delay(48, hopToServer)

    local function setupDiedListener(character)
        local hum = character:FindFirstChildOfClass("Humanoid")
        if hum then
            hum.Died:Connect(hopToServer)
        end
    end

    if LocalPlayer.Character then
        setupDiedListener(LocalPlayer.Character)
    end

    LocalPlayer.CharacterAdded:Connect(setupDiedListener)

    task.spawn(function()
        while task.wait(2) do
            for _, plr in ipairs(Players:GetPlayers()) do
                if plr ~= LocalPlayer and excludedNames[plr.DisplayName] == false then
                    hopToServer()
                    return
                end
            end
        end
    end)

    task.spawn(function()
        while task.wait(0.3) do
            local char = LocalPlayer.Character
            local hum = char and char:FindFirstChildOfClass("Humanoid")
            if hum then
                hum.Health = hum.MaxHealth
            end
        end
    end)

    task.spawn(function()
        while task.wait(0.3) do
            local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            local myDurability = LocalPlayer:FindFirstChild("Durability") and LocalPlayer.Durability.Value

            if root and myDurability then
                for _, plr in ipairs(Players:GetPlayers()) do
                    if plr ~= LocalPlayer and not excludedNames[plr.DisplayName] then
                        local plrChar = plr.Character
                        if plrChar then
                            local targetRoot = plrChar:FindFirstChild("HumanoidRootPart")
                            local stats = plr:FindFirstChild("leaderstats")
                            local strength = stats and stats:FindFirstChild("Strength") and stats.Strength.Value

                            if targetRoot and strength and strength < myDurability * 6.5 then
                                targetRoot.CFrame = root.CFrame * CFrame.new(math.random(-5,5), 0, math.random(-5,5))
                            end
                        end
                    end
                end
            end
        end
    end)

    task.spawn(function()
        local Backpack = LocalPlayer:WaitForChild("Backpack")
        while task.wait(0.1) do
            local tool = Backpack:FindFirstChild("Punch")
            if tool and LocalPlayer.Character then
                local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid and tool.Parent == Backpack then
                    humanoid:EquipTool(tool)
                end
            end
        end
    end)

    task.spawn(function()
        local Backpack = LocalPlayer:WaitForChild("Backpack")
        local tool = Backpack:FindFirstChild("Punch")
        if not tool then return end

        repeat task.wait() until LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        humanoid:EquipTool(tool)

        while task.wait(0.1) do
            if tool.Parent == LocalPlayer.Character then
                tool:Activate()
            end
        end
    end)

    task.spawn(function()
        while task.wait(0.03) do
            local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if root then
                root.CFrame = root.CFrame * CFrame.Angles(0, math.rad(15), 0)
            end
        end
    end)
end)
